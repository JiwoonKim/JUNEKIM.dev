{"componentChunkName":"component---src-components-templates-blog-post-js","path":"/CS50/cs50_beyond/lecture_5/","result":{"data":{"markdownRemark":{"html":"<blockquote>\n<p>Harvard's CS50 Beyond lecture 5 정리</p>\n</blockquote>\n<h3>Thinking in React</h3>\n<p><strong>thinking about how it is that we take an application, decompose it into pieces and put it back together</strong></p>\n<h4>Build React Apps in Real World</h4>\n<ul>\n<li><code>node.js</code>: javascript run-time</li>\n<li><code>create-react-app</code>: build a starter app as default</li>\n<li><code>npm run start</code>: dynamic reloading, automatically separates files</li>\n<li><code>npm run build</code>: compile jsx scripts into javascript</li>\n</ul>\n<h3>Life Cycle Methods</h3>\n<p>functions that run at a particular point in a component's life</p>\n<ul>\n<li>every component has life cycle methods</li>\n</ul>\n<h4>componentDidMount()</h4>\n<p>function run every time a component is mounted (= as soon as component is added to DOM; before the content is ultimately rendered)</p>\n<pre class=\"andromeda vscode-highlight\" data-language=\"jsx\"><code class=\"vscode-highlight-code\"><span class=\"vscode-highlight-line\"><span class=\"mtk7\">componentDidMount</span><span class=\"mtk1\">() {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// update initial state to data in local storage</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk9\">const</span><span class=\"mtk1\"> </span><span class=\"mtk3\">count</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">localStorage</span><span class=\"mtk1\">.</span><span class=\"mtk7\">getItem</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&quot;count&quot;</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk9\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk3\">count</span><span class=\"mtk1\"> </span><span class=\"mtk5\">!==</span><span class=\"mtk1\"> </span><span class=\"mtk5\">null</span><span class=\"mtk1\">) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            count: </span><span class=\"mtk7\">parseInt</span><span class=\"mtk1\">(</span><span class=\"mtk3\">count</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        })</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// store state data into local storage</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk6\">window</span><span class=\"mtk1\">.</span><span class=\"mtk7\">addEventListener</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&quot;beforeunload&quot;</span><span class=\"mtk1\">, () </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk6\">localStorage</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setItem</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&quot;count&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">count</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    });</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">}</span></span></code></pre>\n<h3>Connect with Backend / API</h3>\n<h4>API Call</h4>\n<pre class=\"andromeda vscode-highlight\" data-language=\"jsx\"><code class=\"vscode-highlight-code\"><span class=\"vscode-highlight-line\"><span class=\"mtk4\">// convert currency using API call</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk7\">convertCurrency</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> () </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk9\">const</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">parseFloat</span><span class=\"mtk1\">(</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">setState</span><span class=\"mtk1\">.</span><span class=\"mtk3\">value</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// handle exception: input not a number</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk9\">if</span><span class=\"mtk1\"> </span><span class=\"mtk7\">isNaN</span><span class=\"mtk1\">(</span><span class=\"mtk3\">value</span><span class=\"mtk1\">) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">return</span><span class=\"mtk1\">;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// fetch currency from API and update state</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk7\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&#96;https://api.exchangeratesapi.io/latest?base=</span><span class=\"mtk8\">${</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk8\">}</span><span class=\"mtk12\">&#96;</span><span class=\"mtk1\">)</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    .</span><span class=\"mtk7\">then</span><span class=\"mtk1\">(</span><span class=\"mtk3\">response</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk6\">response</span><span class=\"mtk1\">.</span><span class=\"mtk7\">json</span><span class=\"mtk1\">())</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    .</span><span class=\"mtk7\">then</span><span class=\"mtk1\">(</span><span class=\"mtk3\">data</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            converted: </span><span class=\"mtk6\">data</span><span class=\"mtk1\">.</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">other</span><span class=\"mtk1\">] </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        })</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    })</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">}</span></span></code></pre>\n<h4>Cache</h4>\n<p>use <strong>cache invalidation</strong> (update data upon out-of-date state) <strong>to reduce latency issue</strong></p>\n<pre class=\"andromeda vscode-highlight\" data-language=\"jsx\"><code class=\"vscode-highlight-code\"><span class=\"vscode-highlight-line\"><span class=\"mtk5\">...</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk4\">// create cache variable in component (not state)</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> {};</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk5\">...</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk4\">// within changeCurrency method</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk4\">// check cache for data less than a minute old</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk9\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">] </span><span class=\"mtk5\">!--</span><span class=\"mtk1\"> </span><span class=\"mtk5\">undefined</span><span class=\"mtk1\"> </span><span class=\"mtk5\">&amp;&amp;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk5\">Date</span><span class=\"mtk1\">.</span><span class=\"mtk7\">now</span><span class=\"mtk1\">() </span><span class=\"mtk5\">-</span><span class=\"mtk1\"> </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">].</span><span class=\"mtk3\">timestamp</span><span class=\"mtk1\"> </span><span class=\"mtk5\">&lt;</span><span class=\"mtk1\"> (</span><span class=\"mtk6\">1000</span><span class=\"mtk1\"> </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk6\">60</span><span class=\"mtk1\">)) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            converted: </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">].</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">other</span><span class=\"mtk1\">] </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        })</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">return</span><span class=\"mtk1\">;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">}</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk5\">...</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">.</span><span class=\"mtk7\">then</span><span class=\"mtk1\">(</span><span class=\"mtk3\">data</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// update cache data along w/ timestamp</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">] </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        rates: </span><span class=\"mtk6\">data</span><span class=\"mtk1\">.</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        timestamp: </span><span class=\"mtk6\">Data</span><span class=\"mtk1\">.</span><span class=\"mtk7\">now</span><span class=\"mtk1\">()</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk5\">...</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">})</span></span></code></pre>\n<ul>\n<li>cache = general term for any way to storing data in a particular place</li>\n<li>local storage = type of cache whose data is stored inside browser, useful to persist data even through refreshing</li>\n<li>cookie = keeping track data for interaction between server and browser</li>\n</ul>\n<h3>Currency App (in React)</h3>\n<pre class=\"andromeda vscode-highlight\" data-language=\"jsx\"><code class=\"vscode-highlight-code\"><span class=\"vscode-highlight-line\"><span class=\"mtk9\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7\">App</span><span class=\"mtk1\"> </span><span class=\"mtk9\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtku\">Component</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk9\">constructor</span><span class=\"mtk1\">(</span><span class=\"mtk3\">props</span><span class=\"mtk1\">) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk3\">super</span><span class=\"mtk1\">(</span><span class=\"mtk3\">props</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk4\">// define list of currencies available</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">currencies</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> [</span><span class=\"mtk12\">&quot;USD&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">&quot;KRW&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">&quot;JPY&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk12\">&quot;EUR&quot;</span><span class=\"mtk1\">];</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> {};</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk4\">// define state for component: currency types and values</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">state</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            baseCurrency: </span><span class=\"mtk12\">&quot;USD&quot;</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            otherCurrency: </span><span class=\"mtk12\">&quot;KRW&quot;</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            value: </span><span class=\"mtk6\">0</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            converted: </span><span class=\"mtk6\">0</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        };</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk7\">render</span><span class=\"mtk1\">() {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">return</span><span class=\"mtk1\"> (</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            &lt;</span><span class=\"mtk8\">div</span><span class=\"mtk1\">&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                {</span><span class=\"mtk4\">/* select menu &amp; input for base currency */</span><span class=\"mtk1\">}</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;</span><span class=\"mtk8\">select</span><span class=\"mtk1\"> </span><span class=\"mtk7\">onChange</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">makeSelection</span><span class=\"mtk1\">} </span><span class=\"mtk7\">name</span><span class=\"mtk5\">=</span><span class=\"mtk12\">&quot;base&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">baseCurrency</span><span class=\"mtk1\">}&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                    {</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">currencies</span><span class=\"mtk1\">.</span><span class=\"mtk7\">map</span><span class=\"mtk1\">(</span><span class=\"mtk3\">currency</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> &lt;</span><span class=\"mtk8\">option</span><span class=\"mtk1\"> </span><span class=\"mtk7\">key</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">} </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">}&gt;{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">}&lt;/</span><span class=\"mtk8\">option</span><span class=\"mtk1\">&gt;)}</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;/</span><span class=\"mtk8\">select</span><span class=\"mtk1\">&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;</span><span class=\"mtk8\">input</span><span class=\"mtk1\"> </span><span class=\"mtk7\">onChange</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">changeValue</span><span class=\"mtk1\">} </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">value</span><span class=\"mtk1\">} /&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\"></span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                {</span><span class=\"mtk4\">/* select menu &amp; input for base currency */</span><span class=\"mtk1\">}</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;</span><span class=\"mtk8\">select</span><span class=\"mtk1\"> </span><span class=\"mtk7\">onChange</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">makeSelection</span><span class=\"mtk1\">}  </span><span class=\"mtk7\">name</span><span class=\"mtk5\">=</span><span class=\"mtk12\">&quot;base&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">otherCurrency</span><span class=\"mtk1\">}&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                    {</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">currencies</span><span class=\"mtk1\">.</span><span class=\"mtk7\">map</span><span class=\"mtk1\">(</span><span class=\"mtk3\">currency</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> &lt;</span><span class=\"mtk8\">option</span><span class=\"mtk1\"> </span><span class=\"mtk7\">key</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">} </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">}&gt;{</span><span class=\"mtk3\">currency</span><span class=\"mtk1\">}&lt;/</span><span class=\"mtk8\">option</span><span class=\"mtk1\">&gt;)}</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;/</span><span class=\"mtk8\">select</span><span class=\"mtk1\">&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                &lt;</span><span class=\"mtk8\">input</span><span class=\"mtk1\"> </span><span class=\"mtk7\">disabled</span><span class=\"mtk1\"> </span><span class=\"mtk7\">value</span><span class=\"mtk5\">=</span><span class=\"mtk1\">{</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">converted</span><span class=\"mtk1\"> </span><span class=\"mtk5\">===</span><span class=\"mtk1\"> </span><span class=\"mtk5\">null</span><span class=\"mtk1\"> </span><span class=\"mtk5\">?</span><span class=\"mtk1\"> </span><span class=\"mtk12\">&quot;Calculating...&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk5\">:</span><span class=\"mtk1\"> </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">converted</span><span class=\"mtk1\">} /&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            &lt;/</span><span class=\"mtk8\">div</span><span class=\"mtk1\">&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        )</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// implement changes in selection in &lt;select&gt;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk7\">makeSelection</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk3\">event</span><span class=\"mtk1\">) </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            [</span><span class=\"mtk6\">event</span><span class=\"mtk1\">.</span><span class=\"mtk6\">target</span><span class=\"mtk1\">.</span><span class=\"mtk3\">name</span><span class=\"mtk1\">]: </span><span class=\"mtk6\">event</span><span class=\"mtk1\">.</span><span class=\"mtk6\">target</span><span class=\"mtk1\">.</span><span class=\"mtk3\">value</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        }, </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">convertCurrency</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// change value of base currency input tag</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk7\">changeValue</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> (</span><span class=\"mtk3\">event</span><span class=\"mtk1\">) </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            value: </span><span class=\"mtk6\">event</span><span class=\"mtk1\">.</span><span class=\"mtk6\">target</span><span class=\"mtk1\">.</span><span class=\"mtk3\">value</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            converted: </span><span class=\"mtk5\">null</span><span class=\"mtk1\"> </span><span class=\"mtk4\">// so that value is not constantly changing</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        }, </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">convertCurrency</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk4\">// convert currency </span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    </span><span class=\"mtk7\">convertCurrency</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> () </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">const</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span><span class=\"mtk1\"> </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">parseFloat</span><span class=\"mtk1\">(</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">setState</span><span class=\"mtk1\">.</span><span class=\"mtk3\">value</span><span class=\"mtk1\">);</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk4\">// handle exception: input not a number</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">if</span><span class=\"mtk1\"> </span><span class=\"mtk7\">isNaN</span><span class=\"mtk1\">(</span><span class=\"mtk3\">value</span><span class=\"mtk1\">) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk9\">return</span><span class=\"mtk1\">;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk4\">// use cache if data is less than a minute old</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk9\">if</span><span class=\"mtk1\"> (</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">] </span><span class=\"mtk5\">!===</span><span class=\"mtk1\"> </span><span class=\"mtk5\">undefined</span><span class=\"mtk1\"> </span><span class=\"mtk5\">&amp;&amp;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk5\">Date</span><span class=\"mtk1\">.</span><span class=\"mtk7\">now</span><span class=\"mtk1\">() </span><span class=\"mtk5\">-</span><span class=\"mtk1\"> </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">].</span><span class=\"mtk3\">timestamp</span><span class=\"mtk1\"> </span><span class=\"mtk5\">&lt;</span><span class=\"mtk1\"> (</span><span class=\"mtk6\">1000</span><span class=\"mtk1\"> </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk6\">60</span><span class=\"mtk1\">)) {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                    converted: </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">].</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">other</span><span class=\"mtk1\">] </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span><span class=\"mtk1\">;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                });</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk9\">return</span><span class=\"mtk1\">;</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk4\">// fetch currency from API and update state</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        </span><span class=\"mtk7\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk12\">&#96;https://api.exchangeratesapi.io/latest?base=</span><span class=\"mtk8\">${</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk8\">}</span><span class=\"mtk12\">&#96;</span><span class=\"mtk1\">)</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        .</span><span class=\"mtk7\">then</span><span class=\"mtk1\">(</span><span class=\"mtk3\">response</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> </span><span class=\"mtk6\">response</span><span class=\"mtk1\">.</span><span class=\"mtk7\">json</span><span class=\"mtk1\">())</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        .</span><span class=\"mtk7\">then</span><span class=\"mtk1\">(</span><span class=\"mtk3\">data</span><span class=\"mtk1\"> </span><span class=\"mtk9\">=&gt;</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk4\">// update cached data</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk3\">cached</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">base</span><span class=\"mtk1\">] </span><span class=\"mtk5\">=</span><span class=\"mtk1\"> {</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                rates: </span><span class=\"mtk6\">data</span><span class=\"mtk1\">.</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">,</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                timestamp: </span><span class=\"mtk6\">Data</span><span class=\"mtk1\">.</span><span class=\"mtk7\">now</span><span class=\"mtk1\">()</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            };</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk4\">// update state</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            </span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk7\">setState</span><span class=\"mtk1\">({</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">                converted: </span><span class=\"mtk6\">data</span><span class=\"mtk1\">.</span><span class=\"mtk3\">rates</span><span class=\"mtk1\">[</span><span class=\"mtk11\">this</span><span class=\"mtk1\">.</span><span class=\"mtk6\">state</span><span class=\"mtk1\">.</span><span class=\"mtk3\">other</span><span class=\"mtk1\">] </span><span class=\"mtk5\">*</span><span class=\"mtk1\"> </span><span class=\"mtk3\">value</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">            });</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">        });</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">    }</span></span>\n<span class=\"vscode-highlight-line\"><span class=\"mtk1\">}</span></span></code></pre>\n<style class=\"vscode-highlight-styles\">\n  :root {\n  --vscode-highlight-padding-v: 1rem;\n  --vscode-highlight-padding-h: 1.5rem;\n  --vscode-highlight-padding-top: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-right: var(--vscode-highlight-padding-h);\n  --vscode-highlight-padding-bottom: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-left: var(--vscode-highlight-padding-h);\n  --vscode-highlight-border-radius: 8px;\n\n  --vscode-highlight-line-highlighted-background-color: transparent;\n  --vscode-highlight-line-highlighted-border-width: 4px;\n  --vscode-highlight-line-highlighted-border-color: transparent;\n}\n\n.vscode-highlight {\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n  padding-top: 1rem;\n  padding-top: var(--vscode-highlight-padding-top);\n  padding-bottom: 1rem;\n  padding-bottom: var(--vscode-highlight-padding-bottom);\n  border-radius: 8px;\n  border-radius: var(--vscode-highlight-border-radius);\n  font-feature-settings: normal;\n}\n\n.vscode-highlight-code {\n  display: inline-block;\n  min-width: 100%;\n}\n\n.vscode-highlight-line {\n  display: inline-block;\n  box-sizing: border-box;\n  width: 100%;\n  padding-left: 1.5rem;\n  padding-left: var(--vscode-highlight-padding-left);\n  padding-right: 1.5rem;\n  padding-right: var(--vscode-highlight-padding-right);\n}\n\n.vscode-highlight-line-highlighted {\n  background-color: var(--vscode-highlight-line-highlighted-background-color);\n  box-shadow: inset var(--vscode-highlight-line-highlighted-border-width) 0 0 0 var(--vscode-highlight-line-highlighted-border-color);\n}\n\n  .andromeda {\nbackground-color: #23262E;\ncolor: #D5CED9;\n}\n\n.andromeda .mtk1 { color: #D5CED9; }\n.andromeda .mtk2 { color: #23262E; }\n.andromeda .mtk3 { color: #00E8C6; }\n.andromeda .mtk4 { color: #5F6167; }\n.andromeda .mtk5 { color: #EE5D43; }\n.andromeda .mtk6 { color: #F39C12; }\n.andromeda .mtk7 { color: #FFE66D; }\n.andromeda .mtk8 { color: #F92672; }\n.andromeda .mtk9 { color: #C74DED; }\n.andromeda .mtk10 { color: #7CB7FF; }\n.andromeda .mtk11 { color: #FF00AA; }\n.andromeda .mtk12 { color: #96E072; }\n.andromeda .mtki { font-style: italic; }\n.andromeda .mtkb { font-weight: bold; }\n.andromeda .mtku { text-decoration: underline; text-underline-position: under; }\n</style>","frontmatter":{"title":"CS50 Beyond lecture 5 - Thinking in React","date":"2019-06-08","tags":["CS50","CS50 Beyond","React"]}}},"pageContext":{"slug":"/CS50/cs50_beyond/lecture_5/"}}}